# Repaso Ecuaciones diferenciables

Son funciones que dependen de una variable regularmente el tiempo, tenemos una variable independiente y dependiente.

Con las ecuaciones diferenciables medimos los cambios. Sirven como modelos, para representar situraciones donde una variable cambia:

- Estudiar c√≥mo cambia la y (v.d.) en el tiempo.
- Estudiar la din√°mica de la variable y (v.d.)

Ejemplos:

- Trayectoria de un objeto.
- Fuerzas, deformaciones, estructuras
- Biolog√∫ia: din√°mica de poblaciones, depredador-presa.
- Econom√≠a: equilibrio de mercado, inventario, ventas, etc.
- EDP: modelos de difusi√≥n, ecuaci√≥n de calor, propagaci√≥n de virus, etc.

Podemos tener varias variables independientes (ecuaciones diferenciales parciales) pero para este curso no trabajaremos mucho con esto.

## Notaci√≥n de derivadas

Las derivadas pueden escribirse en diferentes formatos, entre los m√°s comunes:

1. **Notaci√≥n de Leibniz:**

   $$
   \frac{dy}{dx}, \quad \frac{\partial u}{\partial t}
   $$

2. **Notaci√≥n de Newton:**
   Usada principalmente en f√≠sica (tiempo como variable).

   $$
   \dot{y}, \quad \ddot{y}
   $$

3. **Notaci√≥n de Lagrange:**
   Usando ap√≥strofos.

   $$
   y', \; y'', \; y^{(n)}
   $$

4. **Notaci√≥n de operador diferencial:**

   $$
   D_x y, \quad D^n y
   $$

### Est√°ndar a usar en el curso

> (Se completar√° m√°s adelante seg√∫n lo que se indique en clase)

## Clasificaci√≥n de ecuaciones diferenciales

Las **ecuaciones diferenciales** describen relaciones entre una funci√≥n desconocida y sus derivadas. Seg√∫n el tipo de derivadas que aparezcan, se clasifican en:

- **Ecuaciones diferenciales ordinarias (EDO):**
  Aparecen √∫nicamente derivadas respecto a **una variable independiente**.
  Ejemplo:

  $$
  \frac{dy}{dx} = f(x,y)
  $$

- **Ecuaciones diferenciales parciales (EDP):**
  Involucran **derivadas parciales**, es decir, derivadas respecto a **m√°s de una variable independiente**.
  Ejemplo:

  $$
  \frac{\partial u}{\partial t} = \alpha \Delta u
  $$

### Ejemplos cl√°sicos de EDP

1. **Ecuaci√≥n de Poisson:**

   $$
   \Delta u = h(x,y,z)
   $$

2. **Ecuaci√≥n del calor:**

   $$
   \alpha^2 \Delta u + h(x,y,z) = \frac{\partial u}{\partial t}
   $$

3. **Ecuaci√≥n de onda:**

   $$
   c^2 \Delta u + h(x,y,z) = \frac{\partial^2 u}{\partial t^2}
   $$

4. **Ecuaciones de Navier‚ÄìStokes:**

   $$
   \rho\left(\frac{\partial \vec{v}}{\partial t} + \vec{v}\cdot\nabla \vec{v}\right) = -\nabla p + \nabla \cdot T + f
   $$

## Forma general de una ecuaci√≥n diferencial

Una ecuaci√≥n diferencial ordinaria de orden $n$ se puede escribir en **forma general** como:

$$
F(x, y, y', y'', \ldots, y^{(n)}) = 0
$$

- $x$: variable independiente.
- $y$: variable dependiente.
- $y', y'', \ldots, y^{(n)}$: derivadas sucesivas de $y$ respecto a $x$.
- $F$: representa una funci√≥n que combina a $x, y$ y sus derivadas.

üëâ Cuando veamos una ecuaci√≥n escrita as√≠, significa que est√° en su **forma m√°s general**, donde todo est√° contenido en una sola expresi√≥n.

- **Forma general:**

  $$
  F(t, y, y') = 0
  $$

  Aqu√≠ todo est√° expresado en una sola ecuaci√≥n que combina a la variable independiente $t$, la dependiente $y$, y su derivada.

- **Forma normal (expl√≠cita):**

  $$
  \frac{dy}{dt} = f(t, y)
  $$

  En esta forma la derivada queda despejada, lo cual facilita el an√°lisis y la resoluci√≥n.

### Clasificaci√≥n por orden

El **orden** de una ecuaci√≥n diferencial es el de la **derivada de mayor grado** que aparece en la ecuaci√≥n.

- Se parece al ‚Äúexponente‚Äù en un polinomio, pero aqu√≠ en lugar de potencias, lo que cuenta es **hasta qu√© derivada llega la ecuaci√≥n**.

#### Ejemplos

- $\frac{dy}{dx} + 5y = \cos x$ ‚Üí **1er orden**
- $x''' - t^2x' + \sqrt{t}x = 1$ ‚Üí **3er orden**
- $\alpha^2\left(\frac{\partial^4 u}{\partial x^4} + \frac{\partial^4 u}{\partial y^4}\right) = \frac{\partial u}{\partial t}$ ‚Üí **4to orden**

### Sistemas de ecuaciones diferenciales ordinarias (EDO)

Un sistema de EDOs ocurre cuando hay **m√°s de una variable dependiente**, todas relacionadas entre s√≠.

$$
\begin{aligned}
x_1' &= f_1(t, x_1, x_2, \ldots, x_n) \\
x_2' &= f_2(t, x_1, x_2, \ldots, x_n) \\
&\;\;\vdots \\
x_n' &= f_n(t, x_1, x_2, \ldots, x_n)
\end{aligned}
$$

## Sistema en forma vectorial

El sistema que ten√≠as:

$$
\begin{cases}
x_1' = 5t - 4 + x_3 \\
x_2' = \cos(t) + \sin(2t) + 8 \\
x_3' = 1 + x_1 - x_2
\end{cases}
$$

lo podemos reescribir en **forma vectorial compacta**:

$$
\mathbf{x}'(t) = \mathbf{f}(t,\mathbf{x}),
$$

donde

$$
\mathbf{x}(t) =
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix},
\quad
\mathbf{f}(t,\mathbf{x}) =
\begin{bmatrix}
5t - 4 + x_3 \\
\cos(t) + \sin(2t) + 8 \\
1 + x_1 - x_2
\end{bmatrix}.
$$

### ¬øPor qu√© es √∫til?

1. **Se guarda toda la informaci√≥n en una sola ecuaci√≥n:**
   En vez de manejar tres ecuaciones distintas, trabajamos con una sola relaci√≥n vectorial.

2. **Facilita la notaci√≥n y la programaci√≥n:**

   - En computaci√≥n num√©rica, algoritmos como **Euler, Runge‚ÄìKutta, m√©todos impl√≠citos, etc.** requieren precisamente esta forma:
     $\mathbf{x}' = \mathbf{f}(t,\mathbf{x})$.
   - Esto permite escribir el c√≥digo una sola vez para cualquier dimensi√≥n del sistema.

3. **Generalizaci√≥n inmediata:**

   - El ejemplo se dio en $\mathbb{R}^3$, pero lo mismo funciona en $\mathbb{R}^n$.
   - El tama√±o del sistema no importa: siempre podemos escribirlo como una **ecuaci√≥n vectorial**.

4. **Estructura matem√°tica clara:**

   - Se ve de forma natural que $\mathbf{f}:\mathbb{R}\times\mathbb{R}^n\to\mathbb{R}^n$.
   - Esto permite aplicar resultados te√≥ricos de existencia, unicidad y estabilidad.

5. **Separaci√≥n en parte lineal y no lineal:**
   El sistema puede descomponerse en

   $$
   \mathbf{x}' = A\,\mathbf{x} + \mathbf{g}(t),
   $$

   con una matriz $A$ que captura la interacci√≥n entre variables y una funci√≥n $\mathbf{g}(t)$ que captura lo que depende solo del tiempo.
   Esto ayuda a:

   - Identificar si el sistema es lineal o no.
   - Usar m√©todos especiales para sistemas lineales con coeficientes constantes.

## Reducci√≥n de una EDO de orden superior a un sistema de primer orden

- Una **ecuaci√≥n diferencial ordinaria (EDO) de orden $n$** siempre puede transformarse en un **sistema de $n$ ecuaciones de primer orden**.
- Esto significa que **no importa el orden original**, basta con dominar c√≥mo resolver sistemas de **primer orden**.
- En la pr√°ctica (y en la computaci√≥n num√©rica), **siempre se hace esta reducci√≥n** para poder aplicar algoritmos est√°ndar como Runge‚ÄìKutta.

### Ejemplo: EDO de 2¬∫ orden

Supongamos:

$$
y'' + 3y' + 2y = 0
$$

1. Definimos nuevas variables para bajar el orden:

   - Sea $x_1 = y$
   - Sea $x_2 = y'$

2. Escribimos sus derivadas:

   - $x_1' = y' = x_2$
   - $x_2' = y'' = -3y' - 2y = -3x_2 - 2x_1$

3. Sistema equivalente de primer orden:

$$
\begin{cases}
x_1' = x_2 \\
x_2' = -3x_2 - 2x_1
\end{cases}
$$

o en forma vectorial:

$$
\mathbf{x}' =
\begin{bmatrix}
x_1' \\ x_2'
\end{bmatrix}
=
\begin{bmatrix}
x_2 \\ -3x_2 - 2x_1
\end{bmatrix}.
$$

### Ejemplo: EDO de 5¬∫ orden

Si tenemos:

$$
y^{(5)} = f(t, y, y', y'', y^{(3)}, y^{(4)}),
$$

definimos:

$$
x_1 = y, \quad x_2 = y', \quad x_3 = y'', \quad x_4 = y^{(3)}, \quad x_5 = y^{(4)}.
$$

Entonces:

$$
\begin{cases}
x_1' = x_2 \\
x_2' = x_3 \\
x_3' = x_4 \\
x_4' = x_5 \\
x_5' = f(t, x_1, x_2, x_3, x_4, x_5)
\end{cases}
$$

### Ventajas del desacoplamiento

1. **Uniformidad:**
   No importa si la ecuaci√≥n es de orden 2, 5 o 100, **todas se reducen a un sistema de primer orden**.

2. **Computacional:**
   Algoritmos num√©ricos est√°ndar (Euler, Runge‚ÄìKutta, etc.) est√°n dise√±ados para sistemas de primer orden.
   ‚Üí No necesitamos algoritmos distintos para cada orden.

3. **Flexibilidad:**
   El paso de reducci√≥n funciona incluso para ecuaciones no lineales.

4. **Interpretaci√≥n geom√©trica:**
   El sistema equivalente es siempre una **ecuaci√≥n vectorial en $\mathbb{R}^n$**.

   - La trayectoria de la soluci√≥n se interpreta como una **curva en un espacio de dimensi√≥n $n$**.

### Ejemplo concreto

Dada la EDO:

$$
x''' - 4x\,x'' + 7x' - 8x = t + e^t
$$

1. **Aislamos la derivada de mayor orden:**

$$
x''' = t + e^t + 4x\,x'' - 7x' + 8x
$$

2. **Definimos nuevas variables para bajar el orden:**

$$
x_1 = x, \quad x_2 = x', \quad x_3 = x''
$$

3. **Escribimos el sistema equivalente de primer orden:**

$$
\begin{cases}
x_1' = x_2 \\
x_2' = x_3 \\
x_3' = t + e^t + 4x_1x_3 - 7x_2 + 8x_1
\end{cases}
$$

4. **Forma vectorial compacta:**

$$
\mathbf{x}(t) =
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}, \qquad
\mathbf{x}'(t) =
\begin{bmatrix}
x_2 \\
x_3 \\
t + e^t + 4x_1x_3 - 7x_2 + 8x_1
\end{bmatrix}.
$$

## Problema de Valor Inicial (PVI)

Un **problema de valor inicial** se escribe como:

$$
x'(t) = f(t, x), \qquad x(t_0) = x_0
$$

- La ecuaci√≥n diferencial $x' = f(t,x)$ define **la pendiente de la curva soluci√≥n** en cada punto $(t,x)$.
- La condici√≥n inicial $x(t_0) = x_0$ fija **un punto espec√≠fico por el que debe pasar la soluci√≥n**.

### Interpretaci√≥n geom√©trica

1. **Ejes:**

   - Eje horizontal: el tiempo $t$.
   - Eje vertical: la variable dependiente $x(t)$.

2. **Campo de pendientes:**

   - La funci√≥n $f(t,x)$ asigna una pendiente a cada punto del plano $(t,x)$.
   - Esto se puede visualizar como un ‚Äúcampo direccional‚Äù de flechitas que indican hacia d√≥nde crece la soluci√≥n.

3. **Curva soluci√≥n:**

   - Resolver el PVI significa **encontrar la curva que sigue esas pendientes y que adem√°s pasa por el punto inicial $(t_0, x_0)$**.
   - Si no hubiera condici√≥n inicial, habr√≠a muchas curvas posibles.
   - La condici√≥n inicial selecciona **una √∫nica trayectoria**.

### Ejemplo intuitivo

Si tenemos:

$$
x' = -2x, \qquad x(0) = 3
$$

- La EDO sola ($x'=-2x$) describe una familia de soluciones: $x(t) = Ce^{-2t}$, con $C$ constante arbitraria.
- La condici√≥n inicial $x(0)=3$ obliga a que $C=3$.
- As√≠, la soluci√≥n espec√≠fica es $x(t) = 3e^{-2t}$.

üëâ Geom√©tricamente: de todas las curvas exponenciales decrecientes, elegimos la √∫nica que pasa por el punto $(0,3)$.

### Requerimientos de una soluci√≥n de un PVI

Un **PVI** es:

$$
x'(t) = f(t, x), \qquad x(t_0) = x_0
$$

Para que una funci√≥n $x(t)$ sea **soluci√≥n**, debe cumplir:

1. **Diferenciabilidad:**

   - La funci√≥n $x(t)$ debe ser **continua y diferenciable** en el intervalo donde se estudia.
   - Porque la ecuaci√≥n diferencial involucra derivadas, y estas deben existir en todo el intervalo.

2. **Condici√≥n inicial:**

   - En el instante $t_0$, debe cumplirse exactamente

     $$
     x(t_0) = x_0
     $$

3. **Compatibilidad con la ecuaci√≥n diferencial:**

   - Al sustituir $x(t)$ y su derivada $x'(t)$ en la ecuaci√≥n

     $$
     x'(t) \stackrel{?}{=} f(t, x(t)),
     $$

     la igualdad debe cumplirse para todos los $t$ del intervalo.

4. **Continuidad global:**

   - La soluci√≥n no puede tener ‚Äúsaltos‚Äù ni discontinuidades en el intervalo considerado.
   - Ejemplo: la ecuaci√≥n $x' = \tfrac{1}{x}$.

     - La soluci√≥n general es $x(t) = \pm \sqrt{2t + C}$.
     - En $x=0$, la funci√≥n se hace discontinua ‚Üí se rompen las condiciones de soluci√≥n.
     - Por eso en realidad se obtienen **dos soluciones separadas** (una positiva y otra negativa), pero no una sola curva global.

## Teorema de Existencia y Unicidad

Este teorema es fundamental en el estudio de EDOs porque responde dos preguntas clave:

1. **¬øExiste una soluci√≥n que pase por el punto inicial?**
2. **Si existe, esa soluci√≥n es √∫nica o puede haber varias?**

**Observaci√≥n 2.2.3.** En los puntos $(x_0,y_0)$ donde no se cumplen las hip√≥tesis del Teorema de existencia y Unicidad, pueden ocurrir varias cosas:

- puede que no exista soluci√≥n pasando por $(x_0,y_0)$,
- puede que exista m√°s de una soluci√≥n pasando por $(x_0,y_0)$,
- puede que exista una √∫nica soluci√≥n pasando por $(x_0,y_0)$.

### 1. Forma requerida

Escribe siempre el PVI en **forma normal**:

$$
y' = f(x,y),\qquad y(x_0)=y_0.
$$

Aqu√≠ $f(x,y)=x\sqrt{y}$.

### 2. D√≥nde valen las hip√≥tesis (regiones)

Hip√≥tesis del **Teorema de Existencia y Unicidad (Picard‚ÄìLindel√∂f)**:

- $f$ continua en una regi√≥n $R$ que contenga $(x_0,y_0)$.
- $\partial f/\partial y$ continua en esa misma regi√≥n (o $f$ es Lipschitz en $y$).

Para $f(x,y)=x\sqrt{y}$:

- **Continuidad de $f$:** definida y continua s√≥lo para $y\ge 0$.
- **$\partial f/\partial y$:** $\displaystyle \frac{\partial f}{\partial y}=\frac{x}{2\sqrt{y}}$, **continua s√≥lo para $y>0$** (es indefinida en $y=0$).

**Conclusi√≥n de regiones:**

- En $y>0$: $f$ y $\partial f/\partial y$ son continuas ‚áí **existe y es √∫nica** la soluci√≥n local.
- En $y=0$: $f$ es continua pero $\partial f/\partial y$ no ‚áí **puede haber existencia sin unicidad**.
- En $y<0$: $f$ **no** est√° definida (en ‚Ñù) ‚áí **no hay soluci√≥n real**.

### 3. Casos seg√∫n la condici√≥n inicial

#### (a) $y_0>0$  (punto encima del eje $x$)

- Por el teorema: **existe una √∫nica soluci√≥n** en un intervalo alrededor de $x_0$.
- Mientras la trayectoria permanezca en $y>0$, la soluci√≥n se **puede estirar** de forma √∫nica.
- El **l√≠mite de estiramiento** es cuando la curva toca la frontera $y=0$ (si la toca). Ah√≠ **pierde unicidad**.

**Soluci√≥n expl√≠cita** (separable en $y>0$):

$$
\frac{dy}{dx}=x\sqrt{y}
\;\Rightarrow\;
\int \frac{dy}{\sqrt{y}}=\int x\,dx
\;\Rightarrow\;
2\sqrt{y}=\frac{x^2}{2}+C.
$$

Con $y(x_0)=y_0$:

$$
\sqrt{y}=\frac{x^2-x_0^2}{4}+\sqrt{y_0}
\quad\Rightarrow\quad
\boxed{\,y(x)=\Big(\sqrt{y_0}+\tfrac{x^2-x_0^2}{4}\Big)^2\,}
\quad(\text{v√°lida donde }y>0).
$$

**¬øD√≥nde toca $y=0$?**
Resolver $\sqrt{y_0}+\frac{x^2-x_0^2}{4}=0$ ‚áí

$$
x^2=x_0^2-4\sqrt{y_0}.
$$

- Si $x_0^2>4\sqrt{y_0}$ ‚áí hay puntos $x=\pm\sqrt{x_0^2-4\sqrt{y_0}}$ donde la soluci√≥n **llega a $y=0$**.
  Hasta ese primer contacto hay **unicidad**; al tocar $y=0$, **no** hay unicidad hacia adelante.
- Si $x_0^2=4\sqrt{y_0}$ ‚áí la curva **tangencia** $y=0$ en un solo punto.
- Si $x_0^2<4\sqrt{y_0}$ ‚áí **nunca** toca $y=0$; la soluci√≥n √∫nica se **estira globalmente** (para todo $x$).

#### (b) $y_0=0$  (punto sobre el eje $x$)

- El teorema **no garantiza** unicidad (falla $\partial f/\partial y$).
- **Existen varias soluciones** que pasan por $(x_0,0)$. Ejemplos (tomando $x_0=0$ para ilustrar):

  - $y(x)\equiv 0$ (soluci√≥n constante).
  - $y(x)=\tfrac{1}{16}x^4$ (otra soluci√≥n).
  - M√°s en general: soluciones **por tramos** que ‚Äúse pegan‚Äù a $y=0$ un intervalo y luego despegan siguiendo la f√≥rmula expl√≠cita anterior.
    ‚áí **No unicidad** en el eje $y=0$.

#### (c) $y_0<0$  (punto debajo del eje $x$)

- $\sqrt{y}$ no es real ‚áí **no hay soluci√≥n real** que pase por $(x_0,y_0)$.

### 4. Lectura geom√©trica (qu√© ‚Äúse ve‚Äù en el plano $x$-$y$)

- Eje horizontal: $x$. Eje vertical: $y$.
- Para $y>0$, las trayectorias son **‚Äúpar√°bolas‚Äù** (curvas en forma de U) dadas por
  $\;y(x)=\big(\sqrt{y_0}+\frac{x^2-x_0^2}{4}\big)^2$, sim√©tricas respecto a $x=0$.
- En el **eje $y=0$**:

  - Puntos iniciales **sobre** el eje: hay **m√∫ltiples** soluciones (p. ej. $0$ y $\tfrac{1}{16}x^4$).
  - Puntos iniciales **debajo** del eje: **no** hay soluci√≥n.
- **Hasta d√≥nde estirar:** desde $(x_0,y_0>0)$ se estira **mientras $y(x)>0$** (unicidad).
  El primer contacto con $y=0$ marca el **fin del intervalo de unicidad**.

### 5. Por qu√© importa (num√©ricamente)

- Si arrancas en $y_0>0$, los m√©todos (Euler/Runge‚ÄìKutta) funcionan bien **hasta** que la trayectoria se acerque a $y=0$; ah√≠ puede aparecer **no unicidad** y bifurcaciones (la compu no ‚Äúsabe‚Äù qu√© rama seguir).
- Si arrancas con $y_0=0$ o $y_0<0$, **sin an√°lisis previo** el algoritmo puede ‚Äútrabarse‚Äù o dar resultados inconsistentes.
- **Moral:** antes de simular, **verifica la regi√≥n** donde $f$ y $\partial f/\partial y$ son continuas; determina **si hay unicidad** y **hasta d√≥nde** puedes integrar de forma confiable.

## An√°lisis cualitativo de ecuaciones diferenciales

Cuando no tenemos (o no queremos calcular) la **soluci√≥n exacta**, se puede estudiar el comportamiento de las soluciones usando **herramientas cualitativas**.

### 1. An√°lisis de signos de la funci√≥n $f$

Sea un PVI en **forma normal**:

$$
y' = f(x,y).
$$

- La funci√≥n $f(x,y)$ nos dice **la pendiente de la soluci√≥n** en cada punto del plano.
- No necesito un punto inicial para dibujar el ‚Äúcampo direccional‚Äù de pendientes; puedo estudiar el **signo** de $f$.

#### Interpretaci√≥n

- Si $f(x,y) > 0 \implies y'(x) > 0$:
  las curvas soluci√≥n son **crecientes** en esa regi√≥n.
- Si $f(x,y) < 0 \implies y'(x) < 0$:
  las curvas soluci√≥n son **decrecientes** en esa regi√≥n.
- Si $f(x,y) = 0$:
  hay una **soluci√≥n constante** (recta horizontal), o una curva tangente a esa recta.

üëâ Este an√°lisis permite dibujar **hacia d√≥nde se mueven las soluciones** sin resolver nada.

### 2. An√°lisis de concavidad

El siguiente paso es ver c√≥mo **cambia la pendiente** (si sube cada vez m√°s r√°pido o se aplana).
Para esto, se analiza la segunda derivada:

$$
y'' = \frac{d}{dx}(y') = \frac{d}{dx}\big(f(x,y)\big).
$$

Aplicando la regla de la cadena:

$$
y'' = \frac{\partial f}{\partial x}(x,y) + \frac{\partial f}{\partial y}(x,y)\cdot y'.
$$

#### Interpretaci√≥n

- Si $y'' > 0$: la curva es **c√≥ncava hacia arriba** (forma de ‚ÄúU‚Äù).
- Si $y'' < 0$: la curva es **c√≥ncava hacia abajo** (forma de ‚Äú‚à©‚Äù).
